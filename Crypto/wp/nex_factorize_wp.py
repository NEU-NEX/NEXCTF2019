from Crypto.Util import number
import gmpy2
import hashlib

def mul_inv(a, b):
    b0 = b
    x0, x1 = 0,1
    if b==1: return 1
    while a > 1:
        q = a//b
        a, b = b, a%b
        x0, x1 = x1 - q * x0, x0
    if x1 < 0:
        x1 += b0
    return x1

def fermat(n):
    a = gmpy2.isqrt(n)
    b2 = a*a - n
    b = gmpy2.isqrt(n)
    while b*b != b2:
        a = a + 1
        b2 = a * a - n
        b = gmpy2.isqrt(b2)
    q = a + b
    p = a - b
    assert(p * q == n)
    return q,p


flag = "factorizefactorize"
flag = "flag{"+hashlib.md5(flag).hexdigest() +"}"

flag_num = number.bytes_to_long(flag)
#  print flag_num.bit_length()
#  303

length = 512
n = 16278524034278364842964386062476113517067911891699789991355982121084973951738324063305190630865511554888330215827724887964565979607808294168282995825864982603759381323048907814961279012375346497781046417204954101076457350988751188332353062731641153547102721113593787978587135707313755661153376485647168543680503160420091693269984008764444291289486805840439906620313162344057956594836197521501755378387944609246120662335790110901623740990451586621846212047950084207251595169141015645449217847180683357626383565631317253913942886396494396189837432429078251573229378917400841832190737518763297323901586866664595327850603

e = 46531
c = pow(flag_num, e, n)

c = 6312213300571383903571604080174287108445870068869732062888138736917106150731887574660340854207956493820686826920023229075229204503419733263883587197679729306709307251827055280376063427879881805506355676087647775851957802398193484854694179118775777017131618347959436230238132353370495142066610633557776539493834673342543571661567357729466748113346071115946013141514063273924013185529479236641544274827883894821939151054351148150808145062408609105992121679462443852601467155948181840653047059932427022448475245055348711945515464274754531519269654753172737602996351757085312998149425933189147875321678134992252061730977

q, p = fermat(n)
phin = (q - 1) * (p - 1)
d = mul_inv(e, phin)
print number.long_to_bytes(pow(c,d,n))
